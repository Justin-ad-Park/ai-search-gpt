
[설명]
• ConfigMap이 projected volume으로 마운트된 경우, 파일 업데이트는 쿠버네티스 kubelet에 의해 약 1분 내에 파드 파일 시스템에 반영됩니다. 하지만 subPath를 사용하면 변경사항이 반영되지 않습니다.
Elasticsearch의 경우, synonyms는 reload_analyzers를 통해 동적으로 업데이트 가능하지만, user dictionary(Nori 토크나이저)는 정적이어서 인덱스 재생성이나 노드 재시작까지 필요할 수 있습니다. 기존 토큰에는 영향이 적습니다.
만약 filter 내에 path 기반 synonyms를 쓴다면 reload_search_analyzers로 업데이트 가능합니다.
따라서 ConfigMap 수정 → kubelet 동기화 → 마운트된 파일 업데이트 → 필요시 애플리케이션/인덱스 재로드 또는 재생성 순으로 반영합니다.

• 좋은 질문입니다. 적용 방식은 “파일 반영”과 “검색 반영”이 다릅니다.

1. 파일 반영 (K8s 레벨)

- ConfigMap을 수정하면, 일반 볼륨 마운트는 Pod 안 파일이 자동 갱신됩니다(약간의 지연).
- 단, subPath로 마운트하면 자동 갱신이 안 됩니다. 이 경우 재시작 필요합니다.

2. 검색 반영 (Elasticsearch 레벨)

- synonyms(검색 analyzer, updateable: true)는
  ConfigMap 파일 갱신 후 /_reload_search_analyzers 호출로 재시작 없이 반영 가능.
- user_dict_ko(Nori 사용자 사전)는 토크나이저 레벨이라 동적 반영이 어렵습니다.
  보통 신규 인덱스 생성 + 재색인(+alias 전환)으로 적용합니다.

정리

- 동의어 사전: 운영 중 변경 + 리로드 가능
- 사용자 사전: 운영 중 파일 교체만으로는 부족, 재색인 절차가 필요



주요 누락/보완 필요 사항 (우선순위 순)

1. 동의어 파일 방식과 synonyms_set API 방식이 혼재되어 설계가 충돌합니다.

- 문서 앞부분은 synonyms_ko.txt 파일 기반(docs/07.사용자정의사전과동의어처리.md:12)인데, 뒤에서는 /_synonyms/... API 기반(docs/07.사용자정의사전과동의어처리.md:72)을 설명합니다.
- 둘 중 하나를 “기본 운영 방식”으로 명시하지 않으면 구현 시 중복/혼선이 생깁니다.

2. user_dict_ko.txt를 실제 분석기에 연결하는 구체 설정이 없습니다.
- 현재 문서에는 위치만 있고(docs/07.사용자정의사전과동의어처리.md:9), nori_tokenizer에 user_dictionary 또는 user_dictionary_rules를 어떻게 넣는지 예시가 없습니다.
- 이 설정이 없으면 사용자 사전 파일을 만들어도 효과가 없습니다.

3. synonyms_set를 참조하는 analyzer/필터 JSON 예시가 없습니다.

- "synonyms_set": "food-synonyms"를 말하지만(docs/07.사용자정의사전과동의어처리.md:93), 실제 filter/analyzer 정의 스니펫이 없어 적용 시 실수가 쉽습니다.

4. 운영 반영 절차에서 무중단 재색인 절차(alias 전환)가 빠져 있습니다.

- user dictionary 변경은 재색인이 필요하다고만 되어 있고(docs/07.사용자정의사전과동의어처리.md:123),
  index v2 생성 -> reindex -> 검증 -> alias switch 절차가 없어 운영 적용 가이드로는 부족합니다.

5. 검증 데이터 예시가 현재 샘플 데이터와 불일치할 수 있습니다.

- 기대 예시는 “설에 끓여 먹는 생만두”(docs/07.사용자정의사전과동의어처리.md:2,118)인데 현재 데이터에는 해당 문구가 없습니다(현재는 물만두/비건만두 위주).
- 테스트 실패 원인이 기능 문제인지 데이터 문제인지 구분이 어려워집니다.

6. 보안/권한 전제가 문서에 없습니다.

- curl -u elastic:${PASSWORD} 예시는 있지만(docs/07.사용자정의사전과동의어처리.md:82),
  실제 환경에서 필요한 권한(동의어 세트 관리, analyzer reload 권한)과 인증 방식 설명이 없습니다.

정리

- 문서 자체 방향은 좋지만, 지금 상태로는 “바로 구현 가능한 실행 명세”로는 정보가 부족합니다.
- 특히 분석기 실제 JSON, 운영 절차(alias), 검증 데이터 정합성 3가지는 먼저 보강하는 걸 권장합니다.








2. 테스트 시나리오 명칭 불일치

- 본문은 교자 기준인데 테스트 메서드명은 mulmandu를 사용하고 있어 혼동됩니다.
- 위치: docs/07.동의어처리.md:187, docs/07.동의어처리.md:206
- 

3. 데이터셋 기준 단어 검증

- 실제 food-products.json에는 물만두는 있고 교자 문자열은 없습니다.
- 동의어 확장 테스트는 가능하지만, “예시 단어의 데이터 존재성” 관점에선 물만두가 더 안전합니다.
- 근거: src/main/resources/data/food-products.json:124

4. 한국어 분석기 예시 정합성

- 문서 매핑 예시가 standard tokenizer 기반이라, 현재 프로젝트의 nori 기반 구성과 다르면 구현 시 혼선이 생길 수 있습니다.
- 위치: docs/07.동의어처리.md:79, docs/07.동의어처리.md:85

원하면 위 4개를 기준으로 문서를 바로 일관되게 정리해드리겠습니다.


› 1. 예시 동의어 불일치
